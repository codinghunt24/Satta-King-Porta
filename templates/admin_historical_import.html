<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historical Import - Admin Panel</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #111827; color: #fff; }
        .admin-container { display: flex; min-height: 100vh; }
        .sidebar { width: 250px; background: #1f2937; padding: 20px; }
        .sidebar h2 { color: #ffd700; margin-bottom: 30px; }
        .sidebar ul { list-style: none; }
        .sidebar li { margin-bottom: 5px; }
        .sidebar a { display: block; padding: 12px 15px; color: #9ca3af; text-decoration: none; border-radius: 8px; }
        .sidebar a:hover, .sidebar .active a { background: #374151; color: #fff; }
        .main-content { flex: 1; padding: 30px; }
        .card { background: #1f2937; border-radius: 15px; padding: 25px; margin-bottom: 20px; }
        .card-title { color: #ffd700; font-size: 1.3rem; margin-bottom: 20px; border-bottom: 1px solid #374151; padding-bottom: 10px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: linear-gradient(135deg, #1e3a5f 0%, #2d4a6f 100%); padding: 25px; border-radius: 15px; }
        .stat-card h3 { font-size: 2rem; color: #ffd700; }
        .stat-card p { color: #9ca3af; margin-top: 5px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; color: #9ca3af; margin-bottom: 5px; font-weight: 600; }
        .form-group select, .form-group input { width: 100%; padding: 10px; background: #111827; border: 1px solid #374151; border-radius: 6px; color: #fff; font-size: 0.95rem; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
        .form-row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.95rem; font-weight: 600; }
        .btn-primary { background: linear-gradient(135deg, #e94560, #c81e45); color: #fff; }
        .btn-success { background: linear-gradient(135deg, #10b981, #059669); color: #fff; }
        .btn-warning { background: linear-gradient(135deg, #f59e0b, #d97706); color: #fff; }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .alert { padding: 12px 20px; margin-bottom: 15px; border-radius: 8px; }
        .alert-success { background: #065f46; border: 1px solid #10b981; color: #6ee7b7; }
        .alert-error { background: #7f1d1d; border: 1px solid #ef4444; color: #fca5a5; }
        .info-box { background: linear-gradient(135deg, #1e3a5f 0%, #2d4a6f 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .info-box p { color: #9ca3af; margin-bottom: 5px; }
        .info-box strong { color: #ffd700; }
        .section-divider { border: none; border-top: 2px solid #374151; margin: 30px 0; }
        @media (max-width: 768px) {
            .admin-container { flex-direction: column; }
            .sidebar { width: 100%; }
            .form-row, .form-row-2 { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="sidebar">
            <h2>Admin Panel</h2>
            <ul>
                <li><a href="/admin/dashboard?page=dashboard">Dashboard</a></li>
                <li><a href="/admin/dashboard?page=results">Results</a></li>
                <li><a href="/admin/dashboard?page=games">Games</a></li>
                <li><a href="/admin/dashboard?page=posts">Posts</a></li>
                <li><a href="/admin/dashboard?page=daily-posts">Daily Update</a></li>
                <li><a href="/admin/dashboard?page=auto-scrape">Auto Scrape</a></li>
                <li><a href="/admin/dashboard?page=news">News</a></li>
                <li><a href="/admin/dashboard?page=pages">Pages</a></li>
                <li><a href="/admin/dashboard?page=ads">Ads</a></li>
                <li><a href="/admin/dashboard?page=sitemap">Sitemap</a></li>
                <li><a href="/admin/dashboard?page=push">Push Notifications</a></li>
                <li><a href="/admin/dashboard?page=branding">Site Branding</a></li>
                <li class="active"><a href="/admin/historical-import">Historical Import</a></li>
                <li><a href="/admin/redirects">URL Redirects</a></li>
                <li><a href="/admin/logout">Logout</a></li>
            </ul>
        </div>

        <div class="main-content">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div class="alert {% if category == 'success' %}alert-success{% else %}alert-error{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
            {% endif %}
            {% endwith %}

            <h1 style="margin-bottom: 30px; color: #ffd700;">Historical Data Import</h1>

            <div class="stats-grid">
                <div class="stat-card">
                    <h3>{{ total_results }}</h3>
                    <p>Total Results in DB</p>
                </div>
                <div class="stat-card">
                    <h3>{{ total_games }}</h3>
                    <p>Games with Data</p>
                </div>
                <div class="stat-card">
                    <h3>{% if date_range and date_range.min_date %}{{ date_range.min_date }}{% else %}N/A{% endif %}</h3>
                    <p>Earliest Record</p>
                </div>
                <div class="stat-card">
                    <h3>{% if date_range and date_range.max_date %}{{ date_range.max_date }}{% else %}N/A{% endif %}</h3>
                    <p>Latest Record</p>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Single Month Import</h3>
                <div class="info-box">
                    <p>Select a <strong>game</strong>, <strong>month</strong> and <strong>year</strong> to import historical results from satta-king-fast.com</p>
                    <p>Data available from <strong>2015</strong> to present.</p>
                </div>
                <form action="/admin/historical-import/run" method="POST">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Game</label>
                            <select name="game_name" required>
                                <option value="">-- Select Game --</option>
                                {% for game in game_names %}
                                <option value="{{ game }}">{{ game }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Month</label>
                            <select name="month" required>
                                {% for num, name in months %}
                                <option value="{{ num }}">{{ name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Year</label>
                            <select name="year" required>
                                {% for y in years %}
                                <option value="{{ y }}">{{ y }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Import This Month</button>
                </form>
            </div>

            <hr class="section-divider">

            <div class="card">
                <h3 class="card-title">Bulk Import (Multiple Months)</h3>
                <div class="info-box">
                    <p>Import data for a <strong>date range</strong>. Select game and from/to month-year.</p>
                    <p style="color: #f59e0b;">Note: Bulk import may take some time depending on the range. Each month is scraped one by one.</p>
                </div>
                <form action="/admin/historical-import/bulk" method="POST">
                    <div class="form-group">
                        <label>Game</label>
                        <select name="game_name" required>
                            <option value="">-- Select Game --</option>
                            {% for game in game_names %}
                            <option value="{{ game }}">{{ game }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-row-2">
                        <div>
                            <p style="color: #ffd700; margin-bottom: 10px; font-weight: 600;">From</p>
                            <div class="form-row-2">
                                <div class="form-group">
                                    <label>Month</label>
                                    <select name="from_month" required>
                                        {% for num, name in months %}
                                        <option value="{{ num }}" {% if num == 1 %}selected{% endif %}>{{ name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Year</label>
                                    <select name="from_year" required>
                                        {% for y in years %}
                                        <option value="{{ y }}" {% if y == 2015 %}selected{% endif %}>{{ y }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div>
                            <p style="color: #ffd700; margin-bottom: 10px; font-weight: 600;">To</p>
                            <div class="form-row-2">
                                <div class="form-group">
                                    <label>Month</label>
                                    <select name="to_month" required>
                                        {% for num, name in months %}
                                        <option value="{{ num }}" {% if num == 12 %}selected{% endif %}>{{ name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Year</label>
                                    <select name="to_year" required>
                                        {% for y in years %}
                                        <option value="{{ y }}" {% if loop.first %}selected{% endif %}>{{ y }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-warning" onclick="this.innerHTML='Importing... Please wait'; this.disabled=true; this.form.submit();">Bulk Import</button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
