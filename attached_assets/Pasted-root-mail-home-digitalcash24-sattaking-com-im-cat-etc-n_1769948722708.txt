root@mail:/home/digitalcash24/sattaking.com.im# cat /etc/nginx/conf.d/domains/004-sattaking.com.im.conf
server {
    #listen 80;
    listen [::]:80;

    server_name ~^(.*)\.sattaking\.com\.im$;

    set $http_redirect 0;
    if ($host ~ "^(zeslecp|webmail)\.") {
        set $http_redirect 1;
    }

    if ($request_uri ~ "/.well-known/acme-challenge") {
        set $http_redirect 0;
    }

    if ($http_redirect) {
        return 301 https://$host;
    }

    # Set the port for HTTP proxying
    set $PROXY_TO_PORT 8080;


    include conf.d/includes-optional/zesle-proxy-http.conf;
    include conf.d/static-locations/zesle-static-locations.conf;
    include conf.d/server-includes/*.conf;
}

server {
    #listen 443 ssl http2;
    listen [::]:443 ssl http2;

    server_name ~^(.*)\.sattaking\.com\.im$;
    
    ssl_certificate /var/zesle/ssl/letsencrypt/sattaking.com.im/fullchain.pem;
    ssl_certificate_key /var/zesle/ssl/letsencrypt/sattaking.com.im/privkey.pem;


    include conf.d/includes-optional/zesle-proxy-https.conf;

    location /terminal-ws {
        # Any request to this server will first be sent to this URL
        proxy_ssl_server_name on;
        proxy_connect_timeout 7d;
        proxy_send_timeout 7d;
        proxy_read_timeout 7d;

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "Upgrade";
        proxy_set_header Host $host;

        proxy_pass http://127.0.0.1:2086$request_uri;
    }
}

server {
    #listen 80;
    listen [::]:80;

    server_name webmail.sattaking.com.im zeslecp.sattaking.com.im www.sattaking.com.im sattaking.com.im;

    set $http_redirect 0;
    if ($host ~ "^(zeslecp|webmail)\.") {
        set $http_redirect 1;
    }

    if ($request_uri ~ "/.well-known/acme-challenge") {
        set $http_redirect 0;
    }

    if ($http_redirect) {
        return 301 https://$host;
    }

    # Set the port for HTTP proxying
    set $PROXY_TO_PORT 8080;


    include conf.d/includes-optional/zesle-proxy-http.conf;
    include conf.d/static-locations/zesle-static-locations.conf;
    include conf.d/server-includes/*.conf;
}

server {
    #listen 443 ssl http2;
    listen [::]:443 ssl http2;

    server_name webmail.sattaking.com.im zeslecp.sattaking.com.im www.sattaking.com.im sattaking.com.im;
    
    ssl_certificate /var/zesle/ssl/letsencrypt/sattaking.com.im/fullchain.pem;
    ssl_certificate_key /var/zesle/ssl/letsencrypt/sattaking.com.im/privkey.pem;


    include conf.d/includes-optional/zesle-proxy-https.conf;

    location /terminal-ws {
        # Any request to this server will first be sent to this URL
        proxy_ssl_server_name on;
        proxy_connect_timeout 7d;
        proxy_send_timeout 7d;
        proxy_read_timeout 7d;

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "Upgrade";
        proxy_set_header Host $host;

        proxy_pass http://127.0.0.1:2086$request_uri;
    }
}
root@mail:/home/digitalcash24/sattaking.com.im# 